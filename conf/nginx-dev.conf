#generated by `lor framework`
    # user www www;
pid tmp/dev-nginx.pid;

# This number should be at maxium the number of CPU on the server
worker_processes 1;

events {
    # Number of connections per worker
    worker_connections 4096;
}

http {
    sendfile on;
    include ./mime.types;

    lua_package_path "./app/?.lua;./lor/?.lua;$prefix/?.lua;;;;";
    lua_package_cpath "./app/?.so;./lor/?.so;$prefix/?.so;;;;";
    #lua_code_cache on;
    lua_code_cache off;
    lua_shared_dict g_cache 512k;
    charset  utf-8;

    server {
        # List port
        listen 8888;

        # Access log
        access_log logs/dev-access.log;

        # Error log
        error_log logs/dev-error.log;

        client_body_buffer_size      200;

        # this variable is for view render（lua-resty-template)
        set $template_root '';


        location /static {
            alias ./app/static; #app/static;
        }

        location = /index.html {
            root ./app/static; #app/static;
        }

        # lor runtime
        location / {
            #root ./app/static; #app/static;
            #index index.html;
            if ($uri = "/")
            {
               break; #不会匹配后面的rewrite
            }
            if ($request_uri !~ "^/.*_live/")
            {
                rewrite "(.*)" "/default_live/$1" break;
            }
            content_by_lua_file ./app/main.lua;
        }
    }
}

